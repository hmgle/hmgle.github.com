
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="几乎用了整个国庆假期，用C改写了李鲲廉主编的结构力学（第4版）上册附录的pf程序，原pf程序是 用FORTRAN 77写的。期间参考了FORTRAN    90程序设计教程（刘卫国主编）、c程序设计（谭浩强著）、数 值计算方法与c语言工程函数库（杨华中 汪蕙编）p13~p17、 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://hmgle.github.com/blog/page/5">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:hmgle.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/08/e794a8ce8afade8a880e694b9e58699e5b9b3e99da2e5889ae69eb6e99d99e58a9be58886e69e90e7a88be5ba8fefbc88e4b880efbc89/">用C语言改写平面刚架静力分析程序（一）</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-08T22:41:00+08:00" pubdate data-updated="true">Oct 8<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>几乎用了整个国庆假期，用C改写了李鲲廉主编的结构力学（第4版）上册附录的pf程序，原pf程序是</p>

<p>用FORTRAN 77写的。期间参考了FORTRAN    90程序设计教程（刘卫国主编）、c程序设计（谭浩强著）、数</p>

<p>值计算方法与c语言工程函数库（杨华中 汪蕙编）p13~p17、结构矩阵分析与程序设计（温瑞监主编）等书</p>

<p>籍。本打算解方程组自己设计算法，难度大，故继续沿用原程序采用的变带宽LDLT法（改进平方根法）。</p>

<p>程序功能基本保持不变。不考虑异常处理功能，不考虑界面，必须按格式正确输入数据，数据输入错误时</p>

<p>可能不能运行。调试时出现了非常奇怪的问题，对于存在链杆支座的结构可能得出错误的答案，原因目前</p>

<p>不明，郁闷中。使用步骤和原来的一样，见李编的结构力学附录。下面是该书p357上的一个算例：杆件截</p>

<p>面为矩形，柱截面宽0.4m，高0.4m；梁截面宽0.4m，高0.7m（如图）：
<a href="http://hmgle.com/wp-content/uploads/2007/10/frame.jpg"><img src="http://hmgle.com/wp-content/uploads/2007/10/frame.jpg" alt="" /></a></p>

<p>选用弹性模量355e6gpa，求出各截面面积及二次矩，划分好节点和杆件号，输入数据文件内容：</p>

<hr />

<p>*                                                     *</p>

<p>*    算例 21:31 2007-10-8                               *</p>

<p>*                                                     *</p>

<hr />

<p>355e5 9 8 6 1</p>

<p>1 2 0.28 114333e-7</p>

<p>1 3 0.16 213333e-8</p>

<p>2 4 0.16 213333e-8</p>

<p>3 4 0.28 114333e-7</p>

<p>3 5 0.16 213333e-8</p>

<p>4 6 0.16 213333e-8</p>

<p>5 6 0.28 114333e-7</p>

<p>5 7 0.16 213333e-8</p>

<p>6 8 0.16 213333e-8</p>

<p>0 11</p>

<p>6 11</p>

<p>0 7.5</p>

<p>6 7.5</p>

<p>0 4</p>

<p>6 4</p>

<p>0 0</p>

<p>6 0</p>

<p>71 0</p>

<p>72 0</p>

<p>73 0</p>

<p>81 0</p>

<p>82 0</p>

<p>83 0</p>

<p>0</p>

<p>3</p>

<p>2 3 20 3.5</p>

<p>5 3 20 3.5</p>

<p>8 3 20 4</p>

<p>用我改写的程序算，输出结果文件为：</p>

<p>Input Data File Name:suanli.txt</p>

<p>Output File Name:suanliout.txt</p>

<hr />

<p>*                                                     *</p>

<p>*    算例 21:31 2007-10-8                               *</p>

<p>*                                                     *</p>

<hr />

<p>The Input Data</p>

<p>The General Information</p>

<p>E           NM       NJ       NS       NLC</p>

<p>3.550e+007        9        8        6        1</p>

<p>The Information of Members</p>

<p>member    start    end           A                 I</p>

<p>1         1       2     2.800000e-001     1.143330e-002</p>

<p>2         1       3     1.600000e-001     2.133330e-003</p>

<p>3         2       4     1.600000e-001     2.133330e-003</p>

<p>4         3       4     2.800000e-001     1.143330e-002</p>

<p>5         3       5     1.600000e-001     2.133330e-003</p>

<p>6         4       6     1.600000e-001     2.133330e-003</p>

<p>7         5       6     2.800000e-001     1.143330e-002</p>

<p>8         5       7     1.600000e-001     2.133330e-003</p>

<p>9         6       8     1.600000e-001     2.133330e-003</p>

<p>The joint Coordinates</p>

<p>joint          X                 Y</p>

<p>1          0.000000         11.000000</p>

<p>2          6.000000         11.000000</p>

<p>3          0.000000          7.500000</p>

<p>4          6.000000          7.500000</p>

<p>5          0.000000          4.000000</p>

<p>6          6.000000          4.000000</p>

<p>7          0.000000          0.000000</p>

<p>8          6.000000          0.000000</p>

<p>The Information of Supports</p>

<p>IS          VS</p>

<p>71         0.000000</p>

<p>72         0.000000</p>

<p>73         0.000000</p>

<p>81         0.000000</p>

<p>82         0.000000</p>

<p>83         0.000000</p>

<p>Loading Case    1</p>

<p>The Loadings at Joints</p>

<p>NLJ=     0</p>

<p>The Loadings at Members</p>

<p>NLM=     3</p>

<p>membet    type           VF                DST</p>

<p>2        3          20.000000          3.500000</p>

<p>5        3          20.000000          3.500000</p>

<p>8        3          20.000000          4.000000</p>

<p>The Results of Calculation</p>

<p>The Joint Displacements</p>

<p>joint          u                 v              rotation</p>

<p>1     1.340429e-002     5.846036e-005    -4.615768e-005</p>

<p>2     1.339457e-002    -1.297632e-004    -1.431599e-004</p>

<p>3     1.182718e-002     7.475106e-005    -3.457760e-004</p>

<p>4     1.180527e-002    -1.244870e-004    -3.307285e-004</p>

<p>5     7.634272e-003     6.561075e-005    -6.319532e-004</p>

<p>6     7.611849e-003    -9.377977e-005    -6.530693e-004</p>

<p>7     9.045905e-021     9.316727e-021    -1.928831e-020</p>

<p>8     8.954095e-021    -1.331673e-020    -1.914467e-020</p>

<p>The Terminal Forces</p>

<p>member                    FN                FS                  M</p>

<p>1    start     1         16.109058         -8.562519          -19.125643</p>

<p>end     2        -16.109058          8.562519          -32.249471</p>

<p>2    start     1         -8.562519        -16.109058           19.125643</p>

<p>end     3          8.562519        -53.890942           46.992656</p>

<p>3    start     2          8.562519         16.109058           32.249471</p>

<p>end     4         -8.562519        -16.109058           24.132231</p>

<p>4    start     3         36.283916        -41.270895         -124.830605</p>

<p>end     4        -36.283916         41.270895         -122.794767</p>

<p>5    start     3        -49.833414         17.607026           77.837950</p>

<p>end     5         49.833414        -87.607026          106.286642</p>

<p>6    start     4         49.833414         52.392974           98.662536</p>

<p>end     6        -49.833414        -52.392974           84.712873</p>

<p>7    start     5         37.147972        -83.333854         -248.573120</p>

<p>end     6        -37.147972         83.333854         -251.430004</p>

<p>8    start     5       -133.167268         50.459054          142.286478</p>

<p>end     7        133.167268       -130.459054          219.549737</p>

<p>9    start     6        133.167268         89.540946          166.717132</p>

<p>end     8       -133.167268        -89.540946          191.446653</p>

<p>(NA= 165)</p>

<p>这道题结果和答案有点出入，用原来的pf程序算的结果为：</p>

<hr />

<p>*                                                     *</p>

<p>*    算例 21:31 2007-10-8                               *</p>

<p>*                                                     *</p>

<hr />

<p>The Input Data</p>

<p>The General Information</p>

<p>E           NM       NJ       NS       NLC</p>

<p>3.550E+07        9        8        6        1</p>

<p>The Information of Members</p>

<p>member    start    end           A                 I</p>

<p>1         1       2      2.800000E-01      1.143330E-02</p>

<p>2         1       3      1.600000E-01      2.133330E-03</p>

<p>3         2       4      1.600000E-01      2.133330E-03</p>

<p>4         3       4      2.800000E-01      1.143330E-02</p>

<p>5         3       5      1.600000E-01      2.133330E-03</p>

<p>6         4       6      1.600000E-01      2.133330E-03</p>

<p>7         5       6      2.800000E-01      1.143330E-02</p>

<p>8         5       7      1.600000E-01      2.133330E-03</p>

<p>9         6       8      1.600000E-01      2.133330E-03</p>

<p>The Joint Coordinates</p>

<p>joint             X                   Y</p>

<p>1             .000000           11.000000</p>

<p>2            6.000000           11.000000</p>

<p>3             .000000            7.500000</p>

<p>4            6.000000            7.500000</p>

<p>5             .000000            4.000000</p>

<p>6            6.000000            4.000000</p>

<p>7             .000000             .000000</p>

<p>8            6.000000             .000000</p>

<p>The Information of Supports</p>

<p>IS           VS</p>

<p>71           .000000</p>

<p>72           .000000</p>

<p>73           .000000</p>

<p>81           .000000</p>

<p>82           .000000</p>

<p>83           .000000</p>

<p>( NA=     165 )</p>

<p>( NW=     610 )</p>

<p>Loading Case    1</p>

<p>The Loadings at Joints</p>

<p>NLJ=     0</p>

<p>The Loadings at Members</p>

<p>NLM=     3</p>

<p>ILM    ITL             PV              DST</p>

<p>2      3           20.0000          3.500000</p>

<p>5      3           20.0000          3.500000</p>

<p>8      3           20.0000          4.000000</p>

<p>The Results of Calculation</p>

<p>The Joint Displacements</p>

<p>joint          u                 v                phi</p>

<p>1      1.347116E-02      1.297112E-04     -5.784199E-05</p>

<p>2      1.346143E-02     -1.297112E-04     -1.548442E-04</p>

<p>3      1.185913E-02      1.244502E-04     -3.540431E-04</p>

<p>4      1.183723E-02     -1.244502E-04     -3.389956E-04</p>

<p>5      7.643597E-03      9.375904E-05     -6.366158E-04</p>

<p>6      7.621174E-03     -9.375904E-05     -6.577319E-04</p>

<p>7      9.045905E-21      1.331378E-20     -1.929713E-20</p>

<p>8      8.954095E-21     -1.331378E-20     -1.915349E-20</p>

<p>The Terminal Forces</p>

<p>member      N(st)        Q(st)         M(st)        N(en)        Q(en)         M(en)</p>

<p>1       16.109       -8.538       -19.052      -16.109        8.538       -32.176</p>

<p>2       -8.538      -16.109        19.052        8.538      -53.891        47.067</p>

<p>3        8.538       16.109        32.176       -8.538      -16.109        24.206</p>

<p>4       36.284      -41.270      -124.827      -36.284       41.270      -122.791</p>

<p>5      -49.807       17.607        77.760       49.807      -87.607       106.365</p>

<p>6       49.807       52.393        98.585      -49.807      -52.393        84.791</p>

<p>7       37.148      -83.330      -248.563      -37.148       83.330      -251.420</p>

<p>8     -133.138       50.459       142.198      133.138     -130.459       219.638</p>

<p>9      133.138       89.541       166.629     -133.138      -89.541       191.535</p>

<p>( NA=     165 )</p>

<p>( NW=     622 )</p>

<p>其中节点竖直位移相差比较大，其它数据还比较接近。改写的不算成功。正在找bug。</p>

<p>附源程序：</p>

<p>/*用c改写的平面刚架静力分析程序pf(A program for analysis of plane frame)</p>

<p>应该还有错误，慎用</p>

<p>完成时间:2007.10.7*/</p>

<h1>define NULL 0</h1>

<h1>include &lt;stdio.h></h1>

<h1>include &lt;stdlib.h></h1>

<h1>include &lt;math.h></h1>

<p>float E;</p>

<p>int NM;</p>

<p>int NJ;</p>

<p>int NS;</p>

<p>int NLC;</p>

<p>int N;</p>

<p>int MAXBDW;</p>

<p>int NA;</p>

<p>int NLJ;</p>

<p>int NLM;</p>

<p>int *PN=&N;</p>

<p>int *PNA=&NA;</p>

<p>int *PMAXBDW=&MAXBDW;</p>

<p>char CH;</p>

<p>FILE <em>IDFP,</em>OUTFP;</p>

<p>int W1[10000];</p>

<p>float W2[10000];</p>

<p>double W3[1000];</p>

<p>（未完待续）</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2007/10/08/e4b880e38081e5bc80e5a4b4/">一、开头</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2007-10-08T21:55:00+08:00" pubdate data-updated="true">Oct 8<span>th</span>, 2007</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>1、错误在所难免，欢迎批评指正；</p>

<p>2、任何人可自由转载、使用；</p>

<p>3、保持简朴，拒绝华丽。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/4/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/05/01/e6898be69cbae58fb7e7a081patch/">手机号码patch</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/03/17/arme5b9b3e58fb0e4b88be4bd8de59f9fe7bb93e69e84e4bd93e79a84e997aee9a298/">ARM平台下位域结构体的问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/01/12/e98092e5bd92e4b8ade79a84e694b9e8bf9b/">递归中的改进</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/12/26/e4b880e6aca1e99da2e8af95/">一次面试</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/12/11/e79c8be4ba86e8bf99e6a0b7e79a84makefile/">看了这样的makefile</a>
      </li>
    
  </ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
