--- 
layout: post
title: test
categories: 
- "\xE6\x9C\xAA\xE5\x88\x86\xE7\xB1\xBB"
tags: []

status: draft
type: post
published: false
meta: 
  _edit_last: "1"
---
<pre lang="c" line="1">
#include <stdio.h>
#include <stdlib.h>
#define DwHashType 2
unsigned long cryptTable[0x700];

void prepareCryptTable()
{
	int index1 = 0, index2 = 0, i;
	unsigned long seed = 0x00100007; 
	
	for (index1 = 0; index1 < 0x100; index1++)
	{
		for (index2 = index1, i = 0; i < 7; i++,index2 += 0x100)
		{
			unsigned long temp1, temp2;
		
			seed = (seed << 7 + 3) % 0x2AABD7;
			temp1 = (seed & 0xFFFF) << 0x10;
		
			seed = (seed << 7 + 3) % 0x2AABD7;
			temp2 = (seed & 0xFFFF);
		
			cryptTable[index2] = (temp1 | temp2);
		}
	}
}

unsigned long HashString (char *lpszFileName, unsigned long dwHashType)
{
	unsigned char *key = (unsigned char *)lpszFileName;
	unsigned long seed1 = 0x7FED7FED;
	unsigned long seed2 = 0xEEEEEEEE;
	int ch;

	while (*key != 0)
	{
		ch = toupper (*key++);
		seed1 = cryptTable[(dwHashType << 8) + ch] ^ (seed1 + seed2);
		seed2 = ch + seed1 + seed2 + (seed2 << 5) + 3;
	}
	return seed1;
}



int main( int argc, char **argv )
{
    unsigned long ulHashValue;
    int i = 0;

    if ( argc != 2 )
    {
        printf("please input two arguments\n");
        return -1;
    }

     /*初始化数组：crytTable[0x500]*/
     prepareCryptTable();
     
          ulHashValue = HashString( argv[1] ,0);
     printf("\n----%X ----\n", ulHashValue );

     ulHashValue = HashString( argv[1],1);
     printf("----%X ----\n", ulHashValue );

     ulHashValue = HashString( argv[1],2 );
     printf("----%X ----\n", ulHashValue );
	 ulHashValue = HashString( argv[1],0);
     printf("\n----%lu ----\n", ulHashValue );

     ulHashValue = HashString( argv[1],1);
     printf("----%lu ----\n", ulHashValue );

     ulHashValue = HashString( argv[1],2);
     printf("----%lu ----\n", ulHashValue );

     system("pause");
	 return 0;
}
</pre>
